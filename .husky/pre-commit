#!/bin/sh

# ==============================================
# Pre-commit hook: Szybkie sprawdzenia przed kaÅ¼dym commitem
# E2E i build sÄ… w pre-push (wolniejsze operacje)
# ==============================================

echo "ğŸ” Uruchamiam szybkie sprawdzenia przed commitem..."

# 1. Lint - sprawdzenie jakoÅ›ci kodu
echo ""
echo "ğŸ“ Krok 1/3: ESLint - sprawdzanie jakoÅ›ci kodu..."
npm run lint
if [ $? -ne 0 ]; then
  echo "âŒ ESLint: Znaleziono bÅ‚Ä™dy. Popraw je przed commitem."
  exit 1
fi
echo "âœ… ESLint: OK"

# 2. TypeScript - sprawdzenie typÃ³w
echo ""
echo "ğŸ”· Krok 2/3: TypeScript - sprawdzanie typÃ³w..."
npx tsc --noEmit
if [ $? -ne 0 ]; then
  echo "âŒ TypeScript: Znaleziono bÅ‚Ä™dy typÃ³w. Popraw je przed commitem."
  exit 1
fi
echo "âœ… TypeScript: OK"

# 3. Testy jednostkowe (vitest)
echo ""
echo "ğŸ§ª Krok 3/3: Testy jednostkowe (vitest)..."
npm run test:unit
if [ $? -ne 0 ]; then
  echo "âŒ Testy jednostkowe: NiektÃ³re testy nie przeszÅ‚y."
  exit 1
fi
echo "âœ… Testy jednostkowe: OK"

# Wszystko OK
echo ""
echo "âœ… =========================================="
echo "âœ… Pre-commit: Wszystkie szybkie sprawdzenia OK!"
echo "âœ… (E2E i build uruchomiÄ… siÄ™ przed push)"
echo "âœ… =========================================="
